# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Simulation of a neutral network assembly procesess
#'
#' This model simulates an assembly process starting from basal species, that could be fixed with the 
#'   parameter BB or allowed to migrate with rate m. The interactions are established with probability q with 
#'   no restrictions, execpt that double interactions A->B, B->A and self interactions are not allowed. The model 
#'   simulates secondary extinctions, when a predator has all his preys extinct it will become locally exctinct.
#' 
#' @param rho metacommunity number of species
#' @param m   migration rate (probability) from the meta-web   
#' @param q   probability of interaction 
#' @param a   probability of extinction    
#' @param time   time of simulation   
#' @param BB  number of initial basal species present 
#'
#' @return
#'
#' @export
neutralNetAssembly <- function(rho, m, q, a, time, BB = 0L) {
    .Call(`_meweasmo_neutralNetAssembly`, rho, m, q, a, time, BB)
}

#' Simulation of a Cascade fod web assembly procesess
#'
#' This model simulates an assembly process starting from basal species, that could be fixed with the 
#'   parameter BB or allowed to migrate with rate m. The interactions are established with probability q 
#'   if species i>j then i becomes predator and j prey  (i<--j). The model simulates secondary extinctions, 
#'   when a predator has all his preys extinct it will become locally exctinct.
#' 
#' @param rho    metacommunity number of species
#' @param m      migration rate (probability) from the meta-web   
#' @param q      probability of interaction 
#' @param a      extinctions of species (not proportional to C)   
#' @param time   time of simulation   
#' @param BB     number of basal species if 0 will be ~poison(rho*m)   
#' @return       A list with the final the number of species by time S, the number of links by time L, the number of basal species
#'               and the adjacency matrix A. 
#' @export
cascadeNetAssembly <- function(rho, m, q, a, time, BB = 0L) {
    .Call(`_meweasmo_cascadeNetAssembly`, rho, m, q, a, time, BB)
}

#' Simulation of an Assembly process from a Meta-web assuming the interactions are conserved in the local web 
#'
#' This is a dynamical model of colonization and extinction process, with the restriction 
#' that predators must have at least one prey species to survive in the local community,  described in [1] 
#' With an additional secondary extinctions probability that controls when a predator goes extinct if it has
#' no prey.
#' 
#' @references
#' 
#' 1. Galiana, N., Lurgi, M., Claramunt-López, B., Fortin, M.-J., Leroux, S., Cazelles, K., et al. (2018). 
#' The spatial scaling of species interaction networks. Nat. Ecol. Evol., 2, 782–790
#'
#' @param metaW  metacommunity adyacency matrix 
#' @param m      A numeric vector of species' migration rates (probability) from the meta-web   
#' @param e      A numeric vector of species' extinction probability 
#' @param se      A numeric vector of species' secondary extinction probability 
#' @param time   Number of time steps of simulation
#' @return       A list with the final the number of species by time S, the number of links by time L, 
#'               the time series of species STime and the adjacency matrix A with effective links. 
metaWebNetAssembly <- function(metaW, m, e, se, time) {
    .Call(`_meweasmo_metaWebNetAssembly`, metaW, m, e, se, time)
}

#' Simulation of an Assembly process from a Meta-web assuming the interactions are conserved in the local web 
#'
#' This is a dynamical model of colonization and extinction process [1], similar to the TTIB model described in [2]. 
#' With an additional secondary extinctions probability that controls when a predator goes extinct if it has
#' no prey. This is a continuous time version of the model that follows the Gillespie algorithm [3] for simulation
#' There are 3 possible events migration with rate *m*, local extinction with rate *e*, and secondary extinction when
#' a predators has no prey with rate *se*. The parameters are vectors so each species could have their own parameter values.
#' 
#' @references
#' 
#' 1. Saravia, L. A., Marina, T. I., Kristensen, N. P., De Troch, M., & Momo, F. R. (2022). Ecological network assembly: 
#' How the regional metaweb influences local food webs. Journal of Animal Ecology, 91(3), 630–642. https://doi.org/10.1111/1365-2656.13652
#' 2. Galiana, N., Lurgi, M., Claramunt-López, B., Fortin, M.-J., Leroux, S., Cazelles, K., et al. (2018). 
#' The spatial scaling of species interaction networks. Nat. Ecol. Evol., 2, 782–790
#' 3. Gillespie, D. T. (1976). A general method for numerically simulating the stochastic time evolution of coupled chemical reactions. 
#' Journal of Computational Physics, 22(4), 403–434. doi: 10.1016/0021-9991(76)90041-3
#' 
#'
#' @param metaW  metacommunity adyacency matrix 
#' @param m      A numeric vector of species' migration rates (probability) from the meta-web   
#' @param e      A numeric vector of species' extinction probability 
#' @param se      A numeric vector of species' secondary extinction probability 
#' @param time   Number of time steps of simulation
#' @return       A list with the final the number of species by time S, the number of links by time L, 
#'               the time series of species STime and the adjacency matrix A with effective links. 
metaWebNetAssemblyCT <- function(metaW, m, e, se, time) {
    .Call(`_meweasmo_metaWebNetAssemblyCT`, metaW, m, e, se, time)
}

#' Simulation of an Assembly process from a Meta-web assuming stochastic Generalized Lotka-Volterra
#' Local dynamics  
#'
#' @param metaW  NumericMatrix, metacommunity interaction matrix, the values and the signs are the parameters of the LV model  
#' @param m      NumericVector, migration rate (probability) from the meta-web   
#' @param r      NumericVector, grow rate of species, could be negative
#' @param ini    NumericVector, initial condition, or 0  
#' @param time   Number of time steps of simulation
#' @param tau    Number of integration steps for Tau leap method 
#' @return       A list with a vector S the final the number of species by time, L the number of links by time, 
#'               STime a time series of each species with dimension nrow(metaW) x time,
#'               and the adjacency matrix A. 
#' @export
metaWebNetAssemblyGLV <- function(metaW, m, r, ini, time, tau = 0.01) {
    .Call(`_meweasmo_metaWebNetAssemblyGLV`, metaW, m, r, ini, time, tau)
}

#' Calculate the proportion of interactions types in a Lotka-Volterra adjacency matrix
#'
#' @param adjM       Numeric Matrix Lotka-Volterra adjcency matrix  
#' @param sp         Numeric vector with the present species, if species=0 the interaction is not counted
#' 
#' @return           Numeric vector with 5 elements Matrix 1=Mutualistic (+,+), 2=Predator-prey (-,+), 3=Competitive (-,-)
#'                   4=Comensalism (+,0), 5=Amensalism (-,0)
#' @export
calcPropInteractionsGLVadjMat <- function(adjM, spc) {
    .Call(`_meweasmo_calcPropInteractionsGLVadjMat`, adjM, spc)
}

#' Generate random parameters for Lotka-Volterra generalized interaction matrix from Lotka-Volterra adjacency matrix  
#'
#' @param adjM       NumericMatrix, metacommunity interaction matrix, the values and the signs are 
#'                   the parameters of the LV model then a predator prey interaction will be adjM(i,j)=-1 
#'                   adjM(j,i)=1 where j is the predator and i the prey. Competitive interaction is adjM(i,j)=adjM(j,i)=-1
#' @param ef         Eficiency of predator prey interactions
#' @param predIntAvg Average value for the interaction intensity of predator-preys, competition, mutalistic. 
#' @param selfLimAvg Numeric vector, and  also set the average value for diagonal entries of the interaction matrix
#'                   that represent self-limitation, the elements of the vector represent 1=mutualistic, 2=Basal, 3=predator species.
#' @param migrAvg    Average value to generate a uniform random migration with range [0,migrAvg*2] 
#' @param preserveInt if 0 the values are random defined by `rndType` with `predIntAvg` as a mean, if 1 the values of the interactions adjM[i,i] when i!=j are preserved.
#'                    if 2 the values are random uniform with mean given by adjM[i,i] when i!=j.
#' @param predIntSd  Standard deviation of the distribution to generate the interaction values for `preserveInt = 0` and `rndType = 1` gamma distribution.
#'                   For uniform distribution the sd is fixed at `predIntAvg*2 / sqrt(12)`
#' @param rndType    0=uniform, 1=gamma NOTE: this is implemented only for `preserveInt = 0`
#'                                   
#' @return           A list with the interaction matrix interM, the intrinsic growth rates r, and migration values m
#' @export
generateGLVparmsFromAdj <- function(adjM, ef, predIntAvg = 0.01, selfLimAvg = as.numeric( c(0.01, 0.01, 0.01)), migrAvg = 0.0, preserveInt = 0L, predIntSd = 0.01, rndType = 0L) {
    .Call(`_meweasmo_generateGLVparmsFromAdj`, adjM, ef, predIntAvg, selfLimAvg, migrAvg, preserveInt, predIntSd, rndType)
}

#' Generate random Lotka-Volterra adjacency matrix with a given proportion of interactions (approximately)   
#'
#' @param numSp      Integer, number of species 
#' @param C          Double, Probability of interaction = Connectivity = number of interacions/(numSp^2)
#' @param propInt    Numeric vector, Proportion of interactions, there are 5 types of interactions the elements of the vector
#'                   represent 1= mutualism (+,+), 2=Predator-prey (+,-), 3= competition (-,-), 4=Comensalims (+,0), 
#'                   5=Amensalism (-,0). 
#' @return           A NumericMatrix with the GLV type of adjacency matrix  
#' @export
generateRandomGLVadjMat <- function(numSp, C, propInt) {
    .Call(`_meweasmo_generateRandomGLVadjMat`, numSp, C, propInt)
}

